<!DOCTYPE html>
<html>
<head>
  <title>Cart</title>
  <link rel="stylesheet" href="Style/cart.css">
</head>
<body>
  <button class="cart-button" data-bind="text: 'Cart (' + totalQuantity() + ') Total: $' + totalPrice().toFixed(2)">View Cart</button>

  <h1>Cart</h1>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Image</th>        
      </tr>
    </thead>
    <tbody>   
    </tbody>
  </table>
  <p>Total Items: <span id="totalItems" ></span></p>
  <p>Total Price: $<span id="totalPrice"></span></p>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.1/knockout-latest.js"></script>
   <script>
    var cartData = localStorage.getItem('cart');
    var cartItems1 = JSON.parse(cartData);

    cartItems1.forEach(function(row) {
        var tr = document.createElement("tr");
        var tdName = document.createElement("td");
        tdName.textContent = row.name;
        tr.appendChild(tdName);
        var tdprice = document.createElement("td");
        tdprice.textContent = row.price;
        tr.appendChild(tdprice);
        var tdquantity = document.createElement("td");
        tdquantity.textContent = row.quantity;
        tr.appendChild(tdquantity);
        var tdimage = document.createElement("td");
        var image = document.createElement("img");
        image.src = row.image;
        image.alt = row.name;
        image.style.width ="100px";
        tdimage.appendChild(image);
        tr.appendChild(tdimage);
        document.querySelector("tbody").appendChild(tr);
    });

    let totalItems = 0;
    let totalPrice = 0;

    cartItems1.forEach(function(row) {
        totalPrice += parseFloat(row.price.replace('$', '')) * parseInt(row.quantity);
        totalItems += parseInt(row.quantity);
    });

    localStorage.setItem('totalQuantity', totalItems);

    console.log(totalItems);
    document.getElementById('totalPrice').innerHTML = totalPrice;
    document.getElementById('totalItems').innerHTML = totalItems;

    function CartViewModel() {
        var self = this;
        var cartData = localStorage.getItem('cart');
        var cartItems1 = JSON.parse(cartData);
        self.cartItems = ko.observableArray(cartItems1);
         self.totalQuantity = ko.observable(localStorage.getItem('totalQuantity') || 0);

        self.totalPrice = ko.observable(0);

        self.cartItems().forEach(function(row) {
            self.totalPrice(self.totalPrice() + parseFloat(row.price.replace('$', '')) * row.quantity);
        });
    }

    ko.applyBindings(new CartViewModel());

</script>

    
      </script>
    </body>
    </html>
    
